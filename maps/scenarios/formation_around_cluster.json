{
  "name": "Formation Around Rock Cluster",
  "map": "test_rock_cluster.json",
  "description": "Verifies formation adapts when target is blocked by obstacles",

  "setup": {
    "units": [
      {"id": "u1", "team": 0, "type": "worker", "position": [2, 5], "label": "1"},
      {"id": "u2", "team": 0, "type": "worker", "position": [2, 6], "label": "2"},
      {"id": "u3", "team": 0, "type": "worker", "position": [2, 7], "label": "3"},
      {"id": "u4", "team": 0, "type": "worker", "position": [2, 8], "label": "4"},
      {"id": "u5", "team": 0, "type": "worker", "position": [2, 9], "label": "5"}
    ]
  },

  "actions": [
    {
      "tick": 0,
      "type": "move",
      "unitIds": ["u1", "u2", "u3", "u4", "u5"],
      "target": [10, 7],
      "formation": "box"
    }
  ],

  "expectations": {
    "maxTicks": 150,
    "finalState": {
      "units": [
        {"id": "u1", "positionNear": [10, 7], "tolerance": 3, "label": "1'"},
        {"id": "u2", "positionNear": [10, 7], "tolerance": 3, "label": "2'"},
        {"id": "u3", "positionNear": [10, 7], "tolerance": 3, "label": "3'"},
        {"id": "u4", "positionNear": [10, 7], "tolerance": 3, "label": "4'"},
        {"id": "u5", "positionNear": [10, 7], "tolerance": 3, "label": "5'"}
      ]
    },
    "constraints": {
      "noStacking": true,
      "allStopped": true,
      "formationShape": "box"
    }
  },

  "visual": {
    "annotations": [
      {
        "type": "marker",
        "position": [10, 7],
        "label": "Target (rock cluster blocks center)"
      }
    ]
  }
}
